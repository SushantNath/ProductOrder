/*
 * Copyright (C) 2009-2020 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/ui/model/odata/type/Time","sap/ui/core/format/DateFormat","sap/ui/model/Filter"],function(T,D,F){"use strict";return{numberUnit:function(v){if(!v){return"";}return parseFloat(v).toFixed(2);},setHoldIconVisibility:function(M){if(M==="X"||M===true){return true;}else{return false;}},setObjectPageLayoutReference:function(o){this.oObjectPageLayoutinstance=o;},getObjectPageLayoutReference:function(){return this.oObjectPageLayoutinstance;},finalConfirmation:function(f){if(f==="X"){return this.getI18NCommonText("Yes");}else{return this.getI18NCommonText("No");}},setEnableStatus:function(s){if(s==="03"||s==="05"){return true;}else{return false;}},setEnableStatusRelease:function(s){if(s==="01"||s==="02"){return true;}else{return false;}},handleIsuesValue:function(m,p,i){var o=this.getObjectPageLayoutReference();var M=p.ManufacturingOrder;var r=i.oParentBlock.getModel("i18n");var s=i.byId("idMissingComponents");var d=i.byId("idDelay");var q=i.byId("idQltyIssue");var Q=i.byId("idQtyIssue");s.setVisible(false);d.setVisible(false);q.setVisible(false);Q.setVisible(false);q.destroyLink();if(p.OrderHasMissingComponents&&!p.ReservationIsFinallyIssued){var O=new F("ManufacturingOrder",sap.ui.model.FilterOperator.EQ,M);var f=[O];var t=i;m.read("/C_Operationcomponents",{filters:f,success:$.proxy(function(z){if(z.results){var A=[];t.aMaterialArray=[];for(var C=0;C<z.results.length;C++){if(z.results[C].MaterialComponentIsMissing&&!(z.results[C].ReservationIsFinallyIssued)){var B=z.results[C].Material;var j=z.results[C].MissingQuantity;A.push({material:B,MissingQty:j});}}A.sort(function(E,S){return S.MissingQty-E.MissingQty;});if(A.length===1){i.aMaterialArray.push(A[0].material);}else if(A.length>1){i.aMaterialArray.push(A[0].material+" +"+(A.length-1)+" "+r.getProperty("More"));}}var L=new sap.m.Link({text:i.aMaterialArray,press:function(){var S=o.getSections();if(S&&S.length>1){var E=S[3].getSubSections();if(E&&E.length>0){var G=E[0].getBlocks();if(G&&G.length>0){var I=sap.ui.getCore().byId(G[0].getSelectedView());I.byId("btnSegmntComponents").setSelectedButton(I.byId("btnSegmntComponents").getButtons()[1]);I.byId("btnSegmntComponents").fireSelect();}}o.scrollToSection(o.getSections()[3].getId());}}});s.setVisible(true);s.setLink(L);},i),error:$.proxy(function(z){},i)});}if((p.OrderHasQualityIssue==="X")||(p.InspHasRejectedCharc==="X")||(p.InspHasRejectedInspSubset==="X")||(p.InspHasRejectedInspLot==="X")){var a=0;if(p.OrderHasQualityIssue==="X"){var c=p.MfgOrderConfirmedScrapQty;var b=p.MfgOrderPlannedTotalQty;if(c!==0&&b!==0){a=Math.round((c/b)*100);}}if((p.InspHasRejectedCharc==="X")||(p.InspHasRejectedInspSubset==="X")||(p.InspHasRejectedInspLot==="X")){var e=new F("ManufacturingOrder",sap.ui.model.FilterOperator.EQ,M);var g=[e];var h='X';m.read("/C_MPEOrderWithInspLotWithRjcn",{filters:g,success:$.proxy(function(z){var I=[];var A;if(z.results){for(var C=0;C<z.results.length;C++){A=z.results[C].InspectionLot;I.push(A);}}if(I.length>0){var B=new sap.m.Link({text:I,press:function(){var S=o.getSections();if(S&&S.length>1){o.scrollToSection(o.getSections()[6].getId());}}});q.setLink(B);q.setVisible(true);}},i),error:$.proxy(function(z){},i)});}if(a!==0){if(h==='X'){q.setText(i.getI18NCommonText("QualityDeviationScrapAndQM",[a]));}else{q.setText(i.getI18NCommonText("QualityDeviationScrap",[a]));q.setVisible(true);}}else{q.setText(i.getI18NCommonText("QualityDeviationQM"));}}if(p.OrderYieldDeviationQty<0){var j=p.OrderMissingQuantity;var k=p.ProductionUnit;Q.setVisible(true);Q.setText(r.getProperty("QuantityDeviation")+" : "+j+" "+k);}if(p.OrderExecutionEndIsLate||p.OrderExecutionStartIsLate){var l=p.ExecutionEndLatenessInMinutes;var n=p.ExecutionStartLatenessInMins;var u=Math.round(l);var v=Math.round(n);if(u>v){var w=u;}else{w=v;}w=w/(24*60)+":"+w/60%24+":"+w%60;if(parseInt(w.split(":")[0])!==0){var x=parseInt(w.split(":")[0])+r.getProperty("Days");}else{x="";}if(parseInt(w.split(":")[1])!==0){var H=parseInt(w.split(":")[1])+r.getProperty("Hours");}else{H="";}if(parseInt(w.split(":")[2])!==0){var y=parseInt(w.split(":")[2])+r.getProperty("Minutes");}else{y="";}d.setVisible(true);d.setText(r.getProperty("OperationDelayed")+" "+x+" "+H+" "+y+"\n");}},setEnableRereadMD:function(s){if(s==="01"){return true;}else{return false;}},setEnableHoldButton:function(m,M,s){if(m==="EPO"&&M==="X"){if(s==="06"||s==="08"||s==="09"||s==="09"||s==="10"||s==="11"||s==="12"){return false;}else{return true;}}else{return false;}},getButtonStatus:function(p){if(p.OrderIsClosed!=="X"&&p.OrderIsConfirmed!=="X"&&p.OrderIsDeleted!=="X"&&p.OrderIsDelivered!=="X"&&p.OrderIsLocked!=="X"&&p.OrderIsTechnicallyCompleted!=="X"){return true;}else{return false;}},getFeatureAvailability:function(M){if(M==="X"||M===true){return true;}else{return false;}},setEnableConfigButton:function(p){if(p!=="000000000000000000"){return true;}else{return false;}}};});
